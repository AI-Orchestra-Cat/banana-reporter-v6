const _0x3e13c1=_0x495a;(function(_0x4758b4,_0x570ef3){const _0x5b0110=_0x495a,_0x1ae895=_0x4758b4();while(!![]){try{const _0x427c24=-parseInt(_0x5b0110(0x1c9))/0x1*(-parseInt(_0x5b0110(0x23f))/0x2)+-parseInt(_0x5b0110(0x1ad))/0x3+-parseInt(_0x5b0110(0x167))/0x4+parseInt(_0x5b0110(0x1b5))/0x5+parseInt(_0x5b0110(0x18a))/0x6*(parseInt(_0x5b0110(0x220))/0x7)+parseInt(_0x5b0110(0x122))/0x8*(parseInt(_0x5b0110(0x24e))/0x9)+-parseInt(_0x5b0110(0x225))/0xa;if(_0x427c24===_0x570ef3)break;else _0x1ae895['push'](_0x1ae895['shift']());}catch(_0x11343a){_0x1ae895['push'](_0x1ae895['shift']());}}}(_0x3034,0xd21f7));let currentUser=null,currentImageBase64=null,analysisResult=null,visualJudgment=null,userManager=null,tagInputComponents={};const AUTH_CONFIG={'users':[{'id':_0x3e13c1(0x264),'pass':btoa(_0x3e13c1(0x15d)),'role':'admin','limit':0x3e8,'used':0x0},{'id':_0x3e13c1(0x1ef),'pass':btoa(_0x3e13c1(0x1f8)),'role':_0x3e13c1(0x185),'limit':0x1f4,'used':0x0},{'id':'user1','pass':btoa(_0x3e13c1(0x145)),'role':_0x3e13c1(0x20c),'limit':0x64,'used':0x0}]},COLOR_DATA=[{'level':0x2,'name':'オールグリーン','color':_0x3e13c1(0x255),'textColor':_0x3e13c1(0x210),'description':_0x3e13c1(0x200),'recommendation':_0x3e13c1(0x191)},{'level':0x3,'name':'ライトグリーン','color':_0x3e13c1(0x247),'textColor':_0x3e13c1(0x210),'description':_0x3e13c1(0x1f4),'recommendation':_0x3e13c1(0x1ce)},{'level':0x4,'name':_0x3e13c1(0x1fd),'color':_0x3e13c1(0x246),'textColor':_0x3e13c1(0x210),'description':_0x3e13c1(0x241),'recommendation':_0x3e13c1(0x147)},{'level':0x5,'name':_0x3e13c1(0x23b),'color':_0x3e13c1(0x211),'textColor':_0x3e13c1(0x14d),'description':_0x3e13c1(0x182),'recommendation':_0x3e13c1(0x12d)},{'level':0x6,'name':_0x3e13c1(0x216),'color':_0x3e13c1(0x252),'textColor':_0x3e13c1(0x14d),'description':_0x3e13c1(0x1ff),'recommendation':_0x3e13c1(0x222)},{'level':0x7,'name':_0x3e13c1(0x14f),'color':_0x3e13c1(0x146),'textColor':_0x3e13c1(0x14d),'description':_0x3e13c1(0x20b),'recommendation':_0x3e13c1(0x25b)},{'level':0x8,'name':'','color':_0x3e13c1(0x25f),'textColor':_0x3e13c1(0x210),'description':_0x3e13c1(0x1e2),'recommendation':_0x3e13c1(0x22a)},{'level':0x9,'name':'','color':_0x3e13c1(0x265),'textColor':_0x3e13c1(0x210),'description':_0x3e13c1(0x237),'recommendation':'品質劣化・廃棄検討'}],DEFAULT_CLAIM_TYPES=['軸腐れ・先腐れ','傷','病害虫','色むら',_0x3e13c1(0x123),'成熟度異常',_0x3e13c1(0x20d)],UNIT_OPTIONS=['本（個別）',_0x3e13c1(0x21b),_0x3e13c1(0x1b6),_0x3e13c1(0x127),_0x3e13c1(0x234),_0x3e13c1(0x1d6),'コンテナ',_0x3e13c1(0x213),_0x3e13c1(0x20d)],COLOR_PARAMS={'green':{'hueMin':0x50,'hueMax':0x8c,'saturation':0.3,'value':0.4},'yellowGreen':{'hueMin':0x41,'hueMax':0x50,'saturation':0.35,'value':0.5},'yellow':{'hueMin':0x2d,'hueMax':0x41,'saturation':0.4,'value':0.6},'spot':{'size':0xa,'vMin':0.3,'vMax':0.5,'hRange':0xf},'brown':{'hueMin':0x14,'hueMax':0x28,'saturationMax':0.2,'areaRatio':0.15},'backgroundRemoval':{'hueMin':0x14,'hueMax':0x8c,'satMin':0.15,'valMin':0.2,'valMax':0.95,'noiseRemoval':!![]}};function _0x3034(){const _0x47fd71=['yellowHueMin','green','resultCard','\x22\x20alt=\x22選択された画像\x22>','success','recommendation','className','%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>黄色</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>','expert1','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>処理時間</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>','チェーン名','banana_settings','stringify','白みがかった黄色を帯びた状態','users','汎用コード1','map','expert2024','resetBtn','newUserLimit','quantity','currentTarget','ハーフグリーン','adminBtnGroup','全体が黄色い状態','全体が緑色の状態','yellow','yellowHueMax','files','smooth','block','warning','hueMax','forEach','パラメータを初期値に戻しました。','code2','シュガースポットが現れた状態','user','その他','textColor','code3','white','#CDDC39','resetColorParamsBtn','キログラム','getContext','exportBtn','フルイエロー','.param-range','authScreen','used','addUserBtn','房（束）','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>信頼度</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>','ユーザーが見つかりません','greenHueMin','ms</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','24213UsEHyU','ユーザー\x20\x22','食べ頃・販売適期','stageRecommendation','%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>黄緑色</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>','7032670zqYnqg','code1','split','<img\x20src=\x22','.tag-list','早期消費推奨','hostname','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','readAsText','password','スポット%','location','greenSaturation','parse','btn-pulse','ケース','user-','納品日','褐変が進んだ状態','yellowGreen','importCsvBtn','stage','グリーンチップ','result','debugApp','closeAdminBtn','34dvvXIm','信頼度','緑色の部分と黄色の部分が混在','.param-value','.tag-input','vMin','role','#8BC34A','#4CAF50','toDataURL','processingTime','body','error','style','chainName','1275579DviTcb','tags','.visual-color-item','パラメータ保存中にエラーが発生しました。','#FFEB3B','カラー','adminSettingsBtn','#2E7D32','text/csv;charset=utf-8;','display','getImageData','href','visualJudgmentMemo','甘味が増した食べ頃','name','cameraInput','商品名','#FF9800','length','setTags','新しいパスワードが一致しません。','updateUsage','admin','#795548','***','使用回数の上限に達しています。管理者にお問い合わせください。','authAlert','画像を選択してください。','color','spotValueMin','8JiultJ','形状不良','パスワードを変更しました。','captureDate','message','箱（ボックス）','container','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-warning\x20btn-sm\x22\x20onclick=\x22editUser(\x27','join','brown','\x22>×</span>','夏期出荷に適します','replace','.color-item.clickable','input','フォームをリセットしました。','店舗名','tag','values','saturation','onload','assign','storeName','min','Value','ユーザーを追加しました。','createElement','その他%','find','value','remove','設定読み込みエラー:','parentElement','filter','</option>','user2024','#FFC107','追熟有望期の最適色','addEventListener','汎用コード3','ripenessVisual','loginForm','level','black','visualJudgmentCard','スター','解析が完了しました。','100','loginLoading','toLocaleString','percentages','newPassword','toISOString','画像を処理中...','mainScreen','loginBtn','claimTypes','userName','同じIDのユーザーが既に存在します','Bn@7QcX9','classList','loadUsers','getElementById','initialUserInfo','analyzing','requiredFields','\x27)\x22>編集</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-danger\x20btn-sm\x22\x20onclick=\x22deleteUser(\x27','textContent','src','4913240ElkruB','.csv','解析日時','toUpperCase','drawImage','newUserRole','includes','span','\x22\x20style=\x22background:\x20','selected','CSVファイルの読み込み中にエラーが発生しました。','data','%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>緑色</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>','userId','banana_users',';\x22></div>\x0a\x20\x20\x20\x20','mainAlert','danger','CSV出力中にエラーが発生しました。','画像を解析中...','innerHTML','stageValue','saveUsers','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22color-circle\x20color-','tagList','緑色%','getItem','大部分が黄色くなった状態','クレーム種別','confidence','expert','resultContent','pass','productName','requiredFieldsContainer','690kaYEri','画像の処理中にエラーが発生しました。','render','width','deliveryDate','褐色%','stageDescription','追熟が必要です','カラーパラメータを保存しました。','querySelector','dataset','trim','getUsers','slice','greenHueMax','canvas','addUser','claimTypesContainer','authenticate','analyzeBtn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>','さん、ようこそ！','黄色%','totalPixels','spot','<option\x20value=\x22','解析中にエラーが発生しました:\x20','description','addTag','preventDefault','汎用コード2','max','disabled','claimAmount','change','1551990SGpKiS','現在のパスワードが正しくありません。','confirmPassword','removeTag','getTags','unit','fileInput','hidden','5437225dxYroO','袋（パック）','パスワード変更中にエラーが発生しました。','none','add','appendChild','adminPanel','hueMin','.color-item','height','createObjectURL','click','ユーザーを削除しました。','alert\x20alert-','download','banana-report-','新しい使用回数上限を入力してください:','editUser','submit','撮影日','98977GTcYIf','app-selected','mainLoading','解析者','カラーコード','加工初期の色','claimType','127.0.0.1','target','目視判定','CSVファイルをダウンロードしました。','other','scrollIntoView','パレット','csvImportInput','image/jpeg','deleteUser','backgroundRemoval','keydown','DOMContentLoaded','info','querySelectorAll','random','.remove','imagePreview','スポットが広がった状態','colorCode','newUserId','round','limit'];_0x3034=function(){return _0x47fd71;};return _0x3034();}function showAlert(_0x3aba84,_0x3779d0=_0x3e13c1(0x1dd),_0x3e0dee=_0x3e13c1(0x177)){const _0x46e47f=_0x3e13c1,_0x7ce488=document[_0x46e47f(0x160)](_0x3e0dee);if(!_0x7ce488)return;_0x7ce488[_0x46e47f(0x1ed)]=_0x46e47f(0x1c2)+_0x3779d0,_0x7ce488[_0x46e47f(0x165)]=_0x3aba84,_0x7ce488[_0x46e47f(0x15e)][_0x46e47f(0x140)](_0x46e47f(0x1b4)),setTimeout(()=>{const _0x214ccb=_0x46e47f;_0x7ce488[_0x214ccb(0x15e)]['add'](_0x214ccb(0x1b4));},0xbb8);}function getCurrentDateISO(){const _0x239200=_0x3e13c1;return new Date()['toISOString']()[_0x239200(0x227)]('T')[0x0];}function compressImage(_0xfaff14,_0x560d40=0x320,_0x2d5afe=0.7){return new Promise(_0x3d8ae8=>{const _0x22cff5=_0x495a,_0x133cfb=document[_0x22cff5(0x13c)](_0x22cff5(0x199)),_0x36fecd=_0x133cfb[_0x22cff5(0x214)]('2d'),_0x707288=new Image();_0x707288[_0x22cff5(0x136)]=()=>{const _0x53bf3c=_0x22cff5,_0x116742=Math[_0x53bf3c(0x139)](_0x560d40/_0x707288[_0x53bf3c(0x18d)],_0x560d40/_0x707288[_0x53bf3c(0x1be)]);_0x133cfb['width']=_0x707288[_0x53bf3c(0x18d)]*_0x116742,_0x133cfb[_0x53bf3c(0x1be)]=_0x707288[_0x53bf3c(0x1be)]*_0x116742,_0x36fecd['drawImage'](_0x707288,0x0,0x0,_0x133cfb[_0x53bf3c(0x18d)],_0x133cfb[_0x53bf3c(0x1be)]),_0x3d8ae8(_0x133cfb[_0x53bf3c(0x248)](_0x53bf3c(0x1d8),_0x2d5afe));},_0x707288[_0x22cff5(0x166)]=URL[_0x22cff5(0x1bf)](_0xfaff14);});}function rgbToHsv(_0x187c2d,_0x5411ef,_0x59947c){const _0x2b8f20=_0x3e13c1;_0x187c2d/=0xff,_0x5411ef/=0xff,_0x59947c/=0xff;const _0x4b6ab5=Math[_0x2b8f20(0x1a9)](_0x187c2d,_0x5411ef,_0x59947c),_0x2a8546=Math['min'](_0x187c2d,_0x5411ef,_0x59947c),_0xe93c5d=_0x4b6ab5-_0x2a8546;let _0x106f8d=0x0;if(_0xe93c5d!==0x0){if(_0x4b6ab5===_0x187c2d)_0x106f8d=(_0x5411ef-_0x59947c)/_0xe93c5d%0x6;else _0x4b6ab5===_0x5411ef?_0x106f8d=(_0x59947c-_0x187c2d)/_0xe93c5d+0x2:_0x106f8d=(_0x187c2d-_0x5411ef)/_0xe93c5d+0x4;}_0x106f8d=Math[_0x2b8f20(0x1e5)](_0x106f8d*0x3c);if(_0x106f8d<0x0)_0x106f8d+=0x168;const _0x2e88b6=_0x4b6ab5===0x0?0x0:_0xe93c5d/_0x4b6ab5,_0x4e60fa=_0x4b6ab5;return{'h':_0x106f8d,'s':_0x2e88b6,'v':_0x4e60fa};}class TagInput{constructor(_0x33dc1a,_0x114369=[]){const _0x11d020=_0x3e13c1;this[_0x11d020(0x128)]=document[_0x11d020(0x160)](_0x33dc1a),this['input']=this[_0x11d020(0x128)][_0x11d020(0x193)](_0x11d020(0x243)),this['tagList']=this[_0x11d020(0x128)][_0x11d020(0x193)](_0x11d020(0x229)),this[_0x11d020(0x24f)]=[..._0x114369],this['input'][_0x11d020(0x148)](_0x11d020(0x1db),_0x50e9b0=>{const _0x37ed65=_0x11d020;_0x50e9b0['key']==='Enter'&&this[_0x37ed65(0x130)]['value'][_0x37ed65(0x195)]()&&(_0x50e9b0['preventDefault'](),this[_0x37ed65(0x1a6)](this[_0x37ed65(0x130)][_0x37ed65(0x13f)][_0x37ed65(0x195)]()),this[_0x37ed65(0x130)]['value']='');}),this[_0x11d020(0x18c)]();}[_0x3e13c1(0x1a6)](_0x44c9e7){const _0x210016=_0x3e13c1;!this[_0x210016(0x24f)][_0x210016(0x16d)](_0x44c9e7)&&(this[_0x210016(0x24f)]['push'](_0x44c9e7),this[_0x210016(0x18c)]());}[_0x3e13c1(0x1b0)](_0x5a9776){const _0x5b5cc0=_0x3e13c1;this['tags']=this['tags'][_0x5b5cc0(0x143)](_0x200905=>_0x200905!==_0x5a9776),this[_0x5b5cc0(0x18c)]();}['render'](){const _0x3d5bea=_0x3e13c1;this[_0x3d5bea(0x17f)][_0x3d5bea(0x17b)]='',this[_0x3d5bea(0x24f)][_0x3d5bea(0x208)](_0xaa1be4=>{const _0x3f1d46=_0x3d5bea,_0x5eef84=document[_0x3f1d46(0x13c)](_0x3f1d46(0x16e));_0x5eef84[_0x3f1d46(0x1ed)]=_0x3f1d46(0x133),_0x5eef84[_0x3f1d46(0x17b)]=_0xaa1be4+'\x20<span\x20class=\x22remove\x22\x20data-tag=\x22'+_0xaa1be4+_0x3f1d46(0x12c),_0x5eef84[_0x3f1d46(0x193)](_0x3f1d46(0x1e0))[_0x3f1d46(0x148)](_0x3f1d46(0x1c0),_0x138167=>{const _0x4e573f=_0x3f1d46;this[_0x4e573f(0x1b0)](_0x138167[_0x4e573f(0x1d1)][_0x4e573f(0x194)][_0x4e573f(0x133)]);}),this[_0x3f1d46(0x17f)][_0x3f1d46(0x1ba)](_0x5eef84);});}[_0x3e13c1(0x1b1)](){return[...this['tags']];}[_0x3e13c1(0x261)](_0x2a4dc4){const _0x2e4286=_0x3e13c1;this[_0x2e4286(0x24f)]=[..._0x2a4dc4],this['render']();}}class UserManager{constructor(){const _0xd85f3a=_0x3e13c1;this[_0xd85f3a(0x1f5)]=this[_0xd85f3a(0x15f)]();}[_0x3e13c1(0x15f)](){const _0x7c9007=_0x3e13c1,_0x37c660=localStorage['getItem'](_0x7c9007(0x175));return _0x37c660?JSON[_0x7c9007(0x232)](_0x37c660):[...AUTH_CONFIG[_0x7c9007(0x1f5)]];}[_0x3e13c1(0x17d)](){const _0x304b24=_0x3e13c1;localStorage['setItem'](_0x304b24(0x175),JSON['stringify'](this[_0x304b24(0x1f5)]));}[_0x3e13c1(0x19a)](_0x265262,_0x43620a,_0x13a064,_0x2815a4){const _0x171d3a=_0x3e13c1;if(this[_0x171d3a(0x1f5)][_0x171d3a(0x13e)](_0x596d46=>_0x596d46['id']===_0x265262))throw new Error(_0x171d3a(0x15c));return this[_0x171d3a(0x1f5)]['push']({'id':_0x265262,'pass':btoa(_0x43620a),'role':_0x13a064,'limit':parseInt(_0x2815a4),'used':0x0}),this[_0x171d3a(0x17d)](),!![];}[_0x3e13c1(0x1c6)](_0x312374,_0x597fe7){const _0x4faf07=_0x3e13c1,_0x37712e=this[_0x4faf07(0x1f5)][_0x4faf07(0x13e)](_0x52cae8=>_0x52cae8['id']===_0x312374);if(!_0x37712e)throw new Error(_0x4faf07(0x21d));return Object[_0x4faf07(0x137)](_0x37712e,_0x597fe7),this[_0x4faf07(0x17d)](),!![];}['deleteUser'](_0x16127c){const _0x51bd81=_0x3e13c1;return this[_0x51bd81(0x1f5)]=this['users'][_0x51bd81(0x143)](_0x3e529d=>_0x3e529d['id']!==_0x16127c),this[_0x51bd81(0x17d)](),!![];}[_0x3e13c1(0x196)](){const _0x3fbc3a=_0x3e13c1;return this[_0x3fbc3a(0x1f5)]['map'](_0x5de8e1=>({..._0x5de8e1,'pass':_0x3fbc3a(0x266)}));}[_0x3e13c1(0x19c)](_0x133207,_0x2b850d){const _0x2c8750=_0x3e13c1,_0x281159=this[_0x2c8750(0x1f5)][_0x2c8750(0x13e)](_0x78884=>_0x78884['id']===_0x133207&&_0x78884['pass']===btoa(_0x2b850d));return _0x281159||null;}[_0x3e13c1(0x263)](_0x12b5d0){const _0x48a080=_0x3e13c1,_0x27675e=this[_0x48a080(0x1f5)][_0x48a080(0x13e)](_0x18e646=>_0x18e646['id']===_0x12b5d0);_0x27675e&&(_0x27675e[_0x48a080(0x219)]=(_0x27675e[_0x48a080(0x219)]||0x0)+0x1,this[_0x48a080(0x17d)]());}}function analyzeImageOffline(_0x4003b1,_0x3edb6b=COLOR_PARAMS){return new Promise(_0x370d1d=>{setTimeout(()=>{const _0x1d9933=_0x495a,_0x5c0ab7=document[_0x1d9933(0x13c)]('canvas'),_0x2d11fd=_0x5c0ab7[_0x1d9933(0x214)]('2d'),_0x3cbe23=new Image();_0x3cbe23[_0x1d9933(0x136)]=()=>{const _0x2b7dce=_0x1d9933;_0x5c0ab7[_0x2b7dce(0x18d)]=_0x3cbe23[_0x2b7dce(0x18d)],_0x5c0ab7[_0x2b7dce(0x1be)]=_0x3cbe23['height'],_0x2d11fd[_0x2b7dce(0x16b)](_0x3cbe23,0x0,0x0);const _0x2c65a1=_0x2d11fd[_0x2b7dce(0x258)](0x0,0x0,_0x5c0ab7[_0x2b7dce(0x18d)],_0x5c0ab7['height']),_0x1f9d5e=_0x2c65a1[_0x2b7dce(0x172)],_0x232d62={'green':0x0,'yellowGreen':0x0,'yellow':0x0,'spot':0x0,'brown':0x0,'other':0x0};let _0x420b5a=0x0;for(let _0x4f5d74=0x0;_0x4f5d74<_0x1f9d5e[_0x2b7dce(0x260)];_0x4f5d74+=0x4){const _0x56dad3=_0x1f9d5e[_0x4f5d74],_0x5bc115=_0x1f9d5e[_0x4f5d74+0x1],_0x45b2bd=_0x1f9d5e[_0x4f5d74+0x2],_0x358550=rgbToHsv(_0x56dad3,_0x5bc115,_0x45b2bd);if(_0x358550['v']>0.95&&_0x358550['s']<0.05)continue;let _0x4ec93f='other';if(_0x358550['v']<0.25)_0x4ec93f='brown';else{if(_0x358550['s']<0.1)_0x4ec93f=_0x2b7dce(0x1d4);else{if(_0x358550['h']>=_0x3edb6b['green']['hueMin']&&_0x358550['h']<=_0x3edb6b[_0x2b7dce(0x1e8)][_0x2b7dce(0x207)]&&_0x358550['s']>=_0x3edb6b['green']['saturation'])_0x4ec93f=_0x2b7dce(0x1e8);else{if(_0x358550['h']>=_0x3edb6b[_0x2b7dce(0x238)][_0x2b7dce(0x1bc)]&&_0x358550['h']<=_0x3edb6b[_0x2b7dce(0x238)][_0x2b7dce(0x207)]&&_0x358550['s']>=_0x3edb6b[_0x2b7dce(0x238)][_0x2b7dce(0x135)]*0.8)_0x4ec93f=_0x2b7dce(0x238);else{if(_0x358550['h']>=_0x3edb6b[_0x2b7dce(0x201)][_0x2b7dce(0x1bc)]&&_0x358550['h']<=_0x3edb6b[_0x2b7dce(0x201)]['hueMax']&&_0x358550['s']>=_0x3edb6b[_0x2b7dce(0x201)][_0x2b7dce(0x135)]*0.8)_0x4ec93f='yellow';else{if(_0x358550['h']>=0x14&&_0x358550['h']<=0x28&&_0x358550['v']>=_0x3edb6b['spot'][_0x2b7dce(0x244)]&&_0x358550['v']<=_0x3edb6b[_0x2b7dce(0x1a2)]['vMax'])_0x4ec93f='spot';else{if(_0x358550['h']>=_0x3edb6b[_0x2b7dce(0x12b)][_0x2b7dce(0x1bc)]&&_0x358550['h']<=_0x3edb6b[_0x2b7dce(0x12b)][_0x2b7dce(0x207)]&&_0x358550['s']<=_0x3edb6b[_0x2b7dce(0x12b)]['saturationMax']*1.5)_0x4ec93f=_0x2b7dce(0x12b);else _0x358550['h']>=0x1e&&_0x358550['h']<=0x5a&&(_0x4ec93f='yellow');}}}}}}_0x232d62[_0x4ec93f]++,_0x420b5a++;}const _0x5a310f={};for(const _0x123ee4 in _0x232d62){_0x5a310f[_0x123ee4]=_0x232d62[_0x123ee4]/_0x420b5a*0x64;}const _0x36d863=determineRipenessStageLocal(_0x5a310f),_0x78d42f=Math[_0x2b7dce(0x139)](Math['round'](Math[_0x2b7dce(0x1a9)](...Object[_0x2b7dce(0x134)](_0x5a310f))+_0x420b5a/0x3e8),0x64);_0x370d1d({'colorCode':_0x36d863[_0x2b7dce(0x1e3)],'stage':_0x36d863[_0x2b7dce(0x23a)],'confidence':_0x78d42f,'description':_0x36d863[_0x2b7dce(0x1a5)],'recommendation':_0x36d863[_0x2b7dce(0x1ec)],'color':_0x36d863[_0x2b7dce(0x120)],'textColor':_0x36d863[_0x2b7dce(0x20e)],'percentages':{'green':Math[_0x2b7dce(0x1e5)](_0x5a310f['green']*0x64)/0x64,'yellowGreen':Math[_0x2b7dce(0x1e5)](_0x5a310f[_0x2b7dce(0x238)]*0x64)/0x64,'yellow':Math[_0x2b7dce(0x1e5)](_0x5a310f['yellow']*0x64)/0x64,'spot':Math[_0x2b7dce(0x1e5)](_0x5a310f['spot']*0x64)/0x64,'brown':Math[_0x2b7dce(0x1e5)](_0x5a310f[_0x2b7dce(0x12b)]*0x64)/0x64,'other':Math[_0x2b7dce(0x1e5)](_0x5a310f['other']*0x64)/0x64},'totalPixels':_0x420b5a,'timestamp':new Date()[_0x2b7dce(0x156)](),'processingTime':Math[_0x2b7dce(0x1df)]()*0x1f4+0xc8,'isOffline':!![]});},_0x3cbe23[_0x1d9933(0x166)]=_0x4003b1;},0x1f4);});}function determineRipenessStageLocal(_0x479976){const _0x46badb=_0x3e13c1;if(_0x479976[_0x46badb(0x1e8)]>=0x50)return COLOR_DATA[_0x46badb(0x13e)](_0x5374d0=>_0x5374d0['level']===0x2);if(_0x479976[_0x46badb(0x1e8)]>=0x3c)return COLOR_DATA['find'](_0x4dfa29=>_0x4dfa29['level']===0x3);if(_0x479976[_0x46badb(0x1e8)]>=0x1e&&_0x479976[_0x46badb(0x238)]>=0x14)return COLOR_DATA[_0x46badb(0x13e)](_0x24d7fd=>_0x24d7fd[_0x46badb(0x14c)]===0x4);if(_0x479976[_0x46badb(0x201)]>=0x28&&_0x479976[_0x46badb(0x1e8)]<0x1e)return COLOR_DATA[_0x46badb(0x13e)](_0x7a2efb=>_0x7a2efb[_0x46badb(0x14c)]===0x5);if(_0x479976[_0x46badb(0x201)]>=0x46)return COLOR_DATA[_0x46badb(0x13e)](_0x161fb5=>_0x161fb5[_0x46badb(0x14c)]===0x6);if(_0x479976['spot']>=0x5&&_0x479976[_0x46badb(0x1a2)]<0xf)return COLOR_DATA['find'](_0x445b49=>_0x445b49[_0x46badb(0x14c)]===0x7);if(_0x479976[_0x46badb(0x1a2)]>=0xf)return COLOR_DATA[_0x46badb(0x13e)](_0x30b07f=>_0x30b07f[_0x46badb(0x14c)]===0x8);if(_0x479976[_0x46badb(0x12b)]>=0x14)return COLOR_DATA[_0x46badb(0x13e)](_0x411b0f=>_0x411b0f['level']===0x9);return COLOR_DATA[_0x46badb(0x13e)](_0x137cc7=>_0x137cc7[_0x46badb(0x14c)]===0x5);}function initializeApp(){const _0x471b4c=_0x3e13c1,_0x471c09=getCurrentDateISO(),_0x17e7f2=document['getElementById'](_0x471b4c(0x18e)),_0x2da977=document[_0x471b4c(0x160)](_0x471b4c(0x125));if(_0x17e7f2)_0x17e7f2[_0x471b4c(0x13f)]=_0x471c09;if(_0x2da977)_0x2da977[_0x471b4c(0x13f)]=_0x471c09;const _0x4aa4c5=document['getElementById']('unit');_0x4aa4c5&&(_0x4aa4c5[_0x471b4c(0x17b)]=UNIT_OPTIONS['map'](_0x402df2=>_0x471b4c(0x1a3)+_0x402df2+'\x22>'+_0x402df2+_0x471b4c(0x144))[_0x471b4c(0x12a)]('')),userManager=new UserManager(),setupEventListeners(),loadSettings(),(window[_0x471b4c(0x230)]['hostname']==='localhost'||window[_0x471b4c(0x230)][_0x471b4c(0x22b)]===_0x471b4c(0x1d0))&&document[_0x471b4c(0x160)](_0x471b4c(0x161))[_0x471b4c(0x15e)]['remove'](_0x471b4c(0x1b4));}function setupEventListeners(){const _0x57dc99=_0x3e13c1;document[_0x57dc99(0x160)](_0x57dc99(0x14b))['addEventListener'](_0x57dc99(0x1c7),handleLogin),document[_0x57dc99(0x160)]('logoutBtn')[_0x57dc99(0x148)]('click',handleLogout),document[_0x57dc99(0x160)](_0x57dc99(0x25d))[_0x57dc99(0x148)](_0x57dc99(0x1ac),handleImageInput),document['getElementById'](_0x57dc99(0x1b3))['addEventListener'](_0x57dc99(0x1ac),handleImageInput),document[_0x57dc99(0x1de)](_0x57dc99(0x250))[_0x57dc99(0x208)](_0x360e98=>{const _0xb98106=_0x57dc99;_0x360e98[_0xb98106(0x148)]('click',handleVisualJudgment);}),document[_0x57dc99(0x160)](_0x57dc99(0x19d))['addEventListener'](_0x57dc99(0x1c0),handleAnalyze),document[_0x57dc99(0x160)](_0x57dc99(0x215))[_0x57dc99(0x148)](_0x57dc99(0x1c0),handleExport),document['getElementById'](_0x57dc99(0x1f9))[_0x57dc99(0x148)](_0x57dc99(0x1c0),handleReset);const _0x1fe323=document[_0x57dc99(0x160)](_0x57dc99(0x254));_0x1fe323&&_0x1fe323[_0x57dc99(0x148)](_0x57dc99(0x1c0),()=>{const _0x1e434f=_0x57dc99;document[_0x1e434f(0x160)](_0x1e434f(0x1bb))[_0x1e434f(0x15e)][_0x1e434f(0x140)](_0x1e434f(0x1b4)),initializeAdminPanel();}),document['getElementById'](_0x57dc99(0x23e))[_0x57dc99(0x148)](_0x57dc99(0x1c0),()=>{const _0x45b5e5=_0x57dc99;document[_0x45b5e5(0x160)](_0x45b5e5(0x1bb))['classList']['add'](_0x45b5e5(0x1b4));}),document['querySelectorAll'](_0x57dc99(0x12f))[_0x57dc99(0x208)](_0x4251c7=>{const _0x39fe0a=_0x57dc99;_0x4251c7[_0x39fe0a(0x148)](_0x39fe0a(0x1c0),_0x43441d=>{const _0xb729f0=_0x39fe0a,_0x2dca58=parseInt(_0x43441d['currentTarget'][_0xb729f0(0x194)][_0xb729f0(0x14c)]),_0x1bbe67=COLOR_DATA['find'](_0x390327=>_0x390327[_0xb729f0(0x14c)]===_0x2dca58);_0x1bbe67&&showAlert((_0x1bbe67[_0xb729f0(0x25c)]||'カラー'+_0x2dca58)+':\x20'+_0x1bbe67[_0xb729f0(0x1a5)],_0xb729f0(0x1dd));});});}function handleLogin(_0x4c8502){const _0x4cfc99=_0x3e13c1;_0x4c8502[_0x4cfc99(0x1a7)]();const _0x49e2a0=document[_0x4cfc99(0x160)](_0x4cfc99(0x174))[_0x4cfc99(0x13f)],_0x13a3c4=document['getElementById'](_0x4cfc99(0x22e))[_0x4cfc99(0x13f)],_0x22acde=document[_0x4cfc99(0x160)](_0x4cfc99(0x159)),_0x326e65=document[_0x4cfc99(0x160)](_0x4cfc99(0x152));_0x22acde['style'][_0x4cfc99(0x257)]=_0x4cfc99(0x1b8),_0x326e65[_0x4cfc99(0x15e)][_0x4cfc99(0x140)]('hidden'),setTimeout(()=>{const _0x5aa094=_0x4cfc99,_0x18b2e9=userManager[_0x5aa094(0x19c)](_0x49e2a0,_0x13a3c4);if(_0x18b2e9){if(_0x18b2e9[_0x5aa094(0x219)]>=_0x18b2e9['limit']){showAlert(_0x5aa094(0x267),_0x5aa094(0x178),'authAlert'),_0x22acde[_0x5aa094(0x24c)][_0x5aa094(0x257)]=_0x5aa094(0x205),_0x326e65[_0x5aa094(0x15e)]['add'](_0x5aa094(0x1b4));return;}currentUser=_0x18b2e9,userManager['updateUsage'](_0x49e2a0),document['getElementById'](_0x5aa094(0x15b))[_0x5aa094(0x165)]=_0x18b2e9['id'],document[_0x5aa094(0x160)]('userRole')['textContent']=_0x18b2e9['role'][_0x5aa094(0x16a)](),document[_0x5aa094(0x24a)]['className']=_0x5aa094(0x235)+_0x18b2e9['role'],(_0x18b2e9[_0x5aa094(0x245)]===_0x5aa094(0x264)||_0x18b2e9[_0x5aa094(0x245)]==='expert')&&document['getElementById'](_0x5aa094(0x1fe))[_0x5aa094(0x15e)]['remove'](_0x5aa094(0x1b4)),document[_0x5aa094(0x160)](_0x5aa094(0x218))['classList'][_0x5aa094(0x1b9)]('hidden'),document[_0x5aa094(0x160)]('mainScreen')[_0x5aa094(0x15e)][_0x5aa094(0x140)](_0x5aa094(0x1b4)),showAlert(_0x18b2e9['id']+_0x5aa094(0x19f),_0x5aa094(0x1eb));}else showAlert('ユーザーIDまたはパスワードが正しくありません。',_0x5aa094(0x178),_0x5aa094(0x268)),_0x22acde[_0x5aa094(0x24c)][_0x5aa094(0x257)]=_0x5aa094(0x205),_0x326e65[_0x5aa094(0x15e)][_0x5aa094(0x1b9)](_0x5aa094(0x1b4));},0x3e8);}function handleLogout(){const _0x5b2f56=_0x3e13c1;currentUser=null,currentImageBase64=null,analysisResult=null,visualJudgment=null,document[_0x5b2f56(0x160)](_0x5b2f56(0x218))[_0x5b2f56(0x15e)]['remove']('hidden'),document[_0x5b2f56(0x160)](_0x5b2f56(0x158))[_0x5b2f56(0x15e)][_0x5b2f56(0x1b9)]('hidden'),document['body'][_0x5b2f56(0x1ed)]='',document['getElementById'](_0x5b2f56(0x174))[_0x5b2f56(0x13f)]='',document['getElementById'](_0x5b2f56(0x22e))['value']='',document[_0x5b2f56(0x160)](_0x5b2f56(0x159))[_0x5b2f56(0x24c)][_0x5b2f56(0x257)]=_0x5b2f56(0x205),document[_0x5b2f56(0x160)](_0x5b2f56(0x152))[_0x5b2f56(0x15e)]['add'](_0x5b2f56(0x1b4)),handleReset();}async function handleImageInput(_0x29073f){const _0x4aa5f3=_0x3e13c1,_0x5e20b7=_0x29073f[_0x4aa5f3(0x1d1)]['files'][0x0];if(!_0x5e20b7)return;try{showAlert(_0x4aa5f3(0x157),_0x4aa5f3(0x1dd));const _0x302010=await compressImage(_0x5e20b7);currentImageBase64=_0x302010;const _0x106eec=document[_0x4aa5f3(0x160)](_0x4aa5f3(0x1e1));_0x106eec[_0x4aa5f3(0x17b)]=_0x4aa5f3(0x228)+_0x302010+_0x4aa5f3(0x1ea),document[_0x4aa5f3(0x160)](_0x4aa5f3(0x14e))[_0x4aa5f3(0x15e)][_0x4aa5f3(0x140)]('hidden'),document[_0x4aa5f3(0x160)](_0x4aa5f3(0x19d))[_0x4aa5f3(0x1aa)]=![],document[_0x4aa5f3(0x160)]('analyzeBtn')[_0x4aa5f3(0x15e)][_0x4aa5f3(0x1b9)](_0x4aa5f3(0x233)),showAlert('画像が読み込まれました。解析を実行してください。',_0x4aa5f3(0x1eb));}catch(_0x1e2274){showAlert(_0x4aa5f3(0x18b),_0x4aa5f3(0x178)),console[_0x4aa5f3(0x24b)](_0x1e2274);}}function handleVisualJudgment(_0x59d01b){const _0x49cb5a=_0x3e13c1,_0x48805a=parseInt(_0x59d01b['currentTarget'][_0x49cb5a(0x194)][_0x49cb5a(0x14c)]),_0x356d0a=document[_0x49cb5a(0x160)](_0x49cb5a(0x25a))[_0x49cb5a(0x13f)];document['querySelectorAll']('.visual-color-item')['forEach'](_0x5a29f1=>{const _0x36ef7e=_0x49cb5a;_0x5a29f1[_0x36ef7e(0x15e)][_0x36ef7e(0x140)](_0x36ef7e(0x170));}),_0x59d01b[_0x49cb5a(0x1fc)][_0x49cb5a(0x15e)]['add'](_0x49cb5a(0x170));const _0x3a5f28=COLOR_DATA[_0x49cb5a(0x13e)](_0x316c0f=>_0x316c0f[_0x49cb5a(0x14c)]===_0x48805a);visualJudgment={'level':_0x48805a,'stage':_0x3a5f28[_0x49cb5a(0x25c)]||_0x49cb5a(0x253)+_0x48805a,'memo':_0x356d0a,'timestamp':new Date()[_0x49cb5a(0x156)]()},showAlert('目視判定:\x20'+visualJudgment[_0x49cb5a(0x23a)],_0x49cb5a(0x1dd));}async function handleAnalyze(){const _0x2c5304=_0x3e13c1;if(!currentImageBase64){showAlert(_0x2c5304(0x269),'warning');return;}const _0x4c659c=document[_0x2c5304(0x160)](_0x2c5304(0x19d)),_0x5eb1ee=document['getElementById'](_0x2c5304(0x1cb));_0x4c659c[_0x2c5304(0x1aa)]=!![],_0x4c659c['classList']['add'](_0x2c5304(0x162)),_0x4c659c[_0x2c5304(0x15e)][_0x2c5304(0x140)]('btn-pulse'),_0x5eb1ee['classList'][_0x2c5304(0x140)]('hidden');try{showAlert(_0x2c5304(0x17a),_0x2c5304(0x1dd)),analysisResult=await analyzeImageOffline(currentImageBase64),displayResults(analysisResult),document['getElementById'](_0x2c5304(0x215))[_0x2c5304(0x1aa)]=![],showAlert(_0x2c5304(0x150),_0x2c5304(0x1eb));}catch(_0x458dee){showAlert(_0x2c5304(0x1a4)+_0x458dee['message'],_0x2c5304(0x178)),console[_0x2c5304(0x24b)](_0x458dee);}finally{_0x4c659c[_0x2c5304(0x1aa)]=![],_0x4c659c['classList'][_0x2c5304(0x140)](_0x2c5304(0x162)),_0x5eb1ee['classList'][_0x2c5304(0x1b9)]('hidden');}}function displayResults(_0x6874ef){const _0x47c58a=_0x3e13c1,_0x3a16f5=document[_0x47c58a(0x160)](_0x47c58a(0x1e9)),_0x2f4df8=document[_0x47c58a(0x160)](_0x47c58a(0x17c)),_0x38754a=document[_0x47c58a(0x160)](_0x47c58a(0x14a)),_0x9bf82a=document[_0x47c58a(0x160)](_0x47c58a(0x190)),_0x40e40a=document[_0x47c58a(0x160)](_0x47c58a(0x223)),_0x26ba47=document[_0x47c58a(0x160)](_0x47c58a(0x186));_0x2f4df8[_0x47c58a(0x165)]=_0x6874ef[_0x47c58a(0x23a)],_0x2f4df8[_0x47c58a(0x24c)][_0x47c58a(0x120)]=_0x6874ef[_0x47c58a(0x120)],_0x9bf82a[_0x47c58a(0x165)]=_0x6874ef[_0x47c58a(0x1a5)],_0x40e40a[_0x47c58a(0x165)]=_0x6874ef[_0x47c58a(0x1ec)],_0x38754a['innerHTML']=_0x47c58a(0x17e)+_0x6874ef[_0x47c58a(0x1e3)]+_0x47c58a(0x16f)+_0x6874ef[_0x47c58a(0x120)]+';\x20border-color:\x20'+_0x6874ef[_0x47c58a(0x120)]+_0x47c58a(0x176),_0x26ba47['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>カラーコード</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>'+_0x6874ef[_0x47c58a(0x1e3)]+_0x47c58a(0x21c)+_0x6874ef[_0x47c58a(0x184)]+_0x47c58a(0x173)+_0x6874ef['percentages'][_0x47c58a(0x1e8)]+_0x47c58a(0x224)+_0x6874ef[_0x47c58a(0x154)][_0x47c58a(0x238)]+_0x47c58a(0x1ee)+_0x6874ef[_0x47c58a(0x154)][_0x47c58a(0x201)]+'%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>スポット</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>'+_0x6874ef[_0x47c58a(0x154)][_0x47c58a(0x1a2)]+'%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>褐色</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>'+_0x6874ef[_0x47c58a(0x154)][_0x47c58a(0x12b)]+'%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>その他</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>'+_0x6874ef['percentages']['other']+'%</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22result-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-label\x22>解析ピクセル数</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22result-value\x22>'+_0x6874ef[_0x47c58a(0x1a1)][_0x47c58a(0x153)]()+_0x47c58a(0x1f0)+Math['round'](_0x6874ef['processingTime'])+_0x47c58a(0x21f),document[_0x47c58a(0x1de)](_0x47c58a(0x1bd))[_0x47c58a(0x208)](_0x56ed08=>{const _0x3d4a08=_0x47c58a;_0x56ed08[_0x3d4a08(0x15e)][_0x3d4a08(0x140)](_0x3d4a08(0x1ca)),parseInt(_0x56ed08[_0x3d4a08(0x194)][_0x3d4a08(0x14c)])===_0x6874ef[_0x3d4a08(0x1e3)]&&_0x56ed08[_0x3d4a08(0x15e)][_0x3d4a08(0x1b9)](_0x3d4a08(0x1ca));}),_0x3a16f5[_0x47c58a(0x15e)][_0x47c58a(0x140)]('hidden'),_0x3a16f5[_0x47c58a(0x1d5)]({'behavior':_0x47c58a(0x204)});}function handleExport(){const _0x541fd7=_0x3e13c1;if(!analysisResult){showAlert('解析結果がありません。','warning');return;}try{const _0x41654f={'claimType':document['getElementById']('claimType')[_0x541fd7(0x13f)],'deliveryDate':document[_0x541fd7(0x160)](_0x541fd7(0x18e))[_0x541fd7(0x13f)],'captureDate':document[_0x541fd7(0x160)](_0x541fd7(0x125))['value'],'productName':document[_0x541fd7(0x160)](_0x541fd7(0x188))[_0x541fd7(0x13f)],'chainName':document[_0x541fd7(0x160)](_0x541fd7(0x24d))[_0x541fd7(0x13f)],'storeName':document[_0x541fd7(0x160)](_0x541fd7(0x138))[_0x541fd7(0x13f)],'quantity':document[_0x541fd7(0x160)](_0x541fd7(0x1fb))[_0x541fd7(0x13f)],'unit':document['getElementById'](_0x541fd7(0x1b2))[_0x541fd7(0x13f)],'code1':document[_0x541fd7(0x160)](_0x541fd7(0x226))['value'],'code2':document[_0x541fd7(0x160)](_0x541fd7(0x20a))['value'],'code3':document['getElementById']('code3')[_0x541fd7(0x13f)],'claimAmount':document[_0x541fd7(0x160)]('claimAmount')[_0x541fd7(0x13f)]},_0x14e043=[_0x541fd7(0x183),_0x541fd7(0x236),_0x541fd7(0x1c8),_0x541fd7(0x25e),_0x541fd7(0x1f1),_0x541fd7(0x132),'数量','単位',_0x541fd7(0x1f6),_0x541fd7(0x1a8),_0x541fd7(0x149),'希望クレーム請求金額',_0x541fd7(0x1cd),'熟度段階',_0x541fd7(0x240),_0x541fd7(0x180),'黄緑色%',_0x541fd7(0x1a0),_0x541fd7(0x22f),_0x541fd7(0x18f),_0x541fd7(0x13d),'解析ピクセル数','処理時間ms',_0x541fd7(0x1d2),'目視メモ',_0x541fd7(0x1cc),_0x541fd7(0x169)],_0x34e664=[_0x41654f[_0x541fd7(0x1cf)],_0x41654f['deliveryDate'],_0x41654f[_0x541fd7(0x125)],_0x41654f[_0x541fd7(0x188)],_0x41654f['chainName'],_0x41654f[_0x541fd7(0x138)],_0x41654f[_0x541fd7(0x1fb)],_0x41654f[_0x541fd7(0x1b2)],_0x41654f[_0x541fd7(0x226)],_0x41654f[_0x541fd7(0x20a)],_0x41654f[_0x541fd7(0x20f)],_0x41654f[_0x541fd7(0x1ab)],analysisResult[_0x541fd7(0x1e3)],analysisResult[_0x541fd7(0x23a)],analysisResult[_0x541fd7(0x184)],analysisResult['percentages'][_0x541fd7(0x1e8)],analysisResult['percentages'][_0x541fd7(0x238)],analysisResult[_0x541fd7(0x154)][_0x541fd7(0x201)],analysisResult['percentages'][_0x541fd7(0x1a2)],analysisResult[_0x541fd7(0x154)][_0x541fd7(0x12b)],analysisResult['percentages'][_0x541fd7(0x1d4)],analysisResult[_0x541fd7(0x1a1)],Math[_0x541fd7(0x1e5)](analysisResult[_0x541fd7(0x249)]),visualJudgment?visualJudgment[_0x541fd7(0x23a)]:'',visualJudgment?visualJudgment['memo']:'',currentUser?currentUser['id']:'unknown',new Date()[_0x541fd7(0x156)]()],_0x48f8db=[_0x14e043['join'](','),_0x34e664[_0x541fd7(0x1f7)](_0x2e8d67=>'\x22'+_0x2e8d67+'\x22')[_0x541fd7(0x12a)](',')][_0x541fd7(0x12a)]('\x0a'),_0x547c95=new Blob(['\ufeff'+_0x48f8db],{'type':_0x541fd7(0x256)}),_0x1dc07d=document[_0x541fd7(0x13c)]('a'),_0x380c1f=new Date()['toISOString']()[_0x541fd7(0x12e)](/[:.]/g,'-')[_0x541fd7(0x197)](0x0,0x13);_0x1dc07d[_0x541fd7(0x1c3)]=_0x541fd7(0x1c4)+_0x380c1f+_0x541fd7(0x168),_0x1dc07d[_0x541fd7(0x259)]=URL[_0x541fd7(0x1bf)](_0x547c95),_0x1dc07d[_0x541fd7(0x1c0)](),showAlert(_0x541fd7(0x1d3),_0x541fd7(0x1eb));}catch(_0x4e573c){showAlert(_0x541fd7(0x179),_0x541fd7(0x178)),console[_0x541fd7(0x24b)](_0x4e573c);}}function _0x495a(_0x205692,_0x4ec928){const _0x3034fc=_0x3034();return _0x495a=function(_0x495a7d,_0x4b0ad2){_0x495a7d=_0x495a7d-0x120;let _0x7924e2=_0x3034fc[_0x495a7d];return _0x7924e2;},_0x495a(_0x205692,_0x4ec928);}function handleReset(){const _0x3e80b4=_0x3e13c1;currentImageBase64=null,analysisResult=null,visualJudgment=null,document[_0x3e80b4(0x160)](_0x3e80b4(0x1e1))[_0x3e80b4(0x17b)]='<div\x20class=\x22image-placeholder\x22>画像が選択されていません</div>',document[_0x3e80b4(0x160)](_0x3e80b4(0x25d))[_0x3e80b4(0x13f)]='',document['getElementById'](_0x3e80b4(0x1b3))[_0x3e80b4(0x13f)]='',document[_0x3e80b4(0x1de)]('.visual-color-item')[_0x3e80b4(0x208)](_0x3b6e8f=>{const _0x3c73e2=_0x3e80b4;_0x3b6e8f[_0x3c73e2(0x15e)]['remove'](_0x3c73e2(0x170));}),document[_0x3e80b4(0x160)](_0x3e80b4(0x25a))['value']='',document[_0x3e80b4(0x160)](_0x3e80b4(0x14e))[_0x3e80b4(0x15e)][_0x3e80b4(0x1b9)]('hidden'),document[_0x3e80b4(0x160)](_0x3e80b4(0x19d))[_0x3e80b4(0x1aa)]=!![],document[_0x3e80b4(0x160)]('analyzeBtn')[_0x3e80b4(0x15e)][_0x3e80b4(0x140)](_0x3e80b4(0x233),_0x3e80b4(0x162)),document[_0x3e80b4(0x160)]('exportBtn')[_0x3e80b4(0x1aa)]=!![],document[_0x3e80b4(0x160)]('resultCard')[_0x3e80b4(0x15e)][_0x3e80b4(0x1b9)](_0x3e80b4(0x1b4)),document['querySelectorAll'](_0x3e80b4(0x1bd))['forEach'](_0x1b8960=>{const _0x32a880=_0x3e80b4;_0x1b8960[_0x32a880(0x15e)]['remove'](_0x32a880(0x1ca));});const _0x456e4e=getCurrentDateISO();document['getElementById'](_0x3e80b4(0x1cf))[_0x3e80b4(0x13f)]='',document[_0x3e80b4(0x160)](_0x3e80b4(0x18e))[_0x3e80b4(0x13f)]=_0x456e4e,document['getElementById'](_0x3e80b4(0x125))[_0x3e80b4(0x13f)]=_0x456e4e,document['getElementById']('productName')[_0x3e80b4(0x13f)]='',document[_0x3e80b4(0x160)](_0x3e80b4(0x24d))[_0x3e80b4(0x13f)]='',document['getElementById'](_0x3e80b4(0x138))['value']='',document[_0x3e80b4(0x160)]('quantity')['value']='',document[_0x3e80b4(0x160)](_0x3e80b4(0x1b2))['value']=UNIT_OPTIONS[0x0],document[_0x3e80b4(0x160)](_0x3e80b4(0x226))[_0x3e80b4(0x13f)]='',document[_0x3e80b4(0x160)]('code2')['value']='',document[_0x3e80b4(0x160)]('code3')['value']='',document[_0x3e80b4(0x160)](_0x3e80b4(0x1ab))['value']='',showAlert(_0x3e80b4(0x131),_0x3e80b4(0x1dd));}function initializeAdminPanel(){const _0x57f3d6=_0x3e13c1;!tagInputComponents[_0x57f3d6(0x163)]&&(tagInputComponents['requiredFields']=new TagInput(_0x57f3d6(0x189),getRequiredFields())),!tagInputComponents['claimTypes']&&(tagInputComponents[_0x57f3d6(0x15a)]=new TagInput(_0x57f3d6(0x19b),getClaimTypes())),updateUserTable(),initializeColorParams(),setupAdminEventListeners();}function setupAdminEventListeners(){const _0x5e4cea=_0x3e13c1;document[_0x5e4cea(0x160)](_0x5e4cea(0x21a))[_0x5e4cea(0x148)](_0x5e4cea(0x1c0),handleAddUser),document['getElementById']('saveColorParamsBtn')['addEventListener'](_0x5e4cea(0x1c0),saveColorParams),document['getElementById'](_0x5e4cea(0x212))[_0x5e4cea(0x148)]('click',resetColorParams),document[_0x5e4cea(0x160)](_0x5e4cea(0x239))['addEventListener'](_0x5e4cea(0x1c0),handleCsvImport),document[_0x5e4cea(0x160)]('changePasswordBtn')['addEventListener'](_0x5e4cea(0x1c0),handlePasswordChange);}function handleAddUser(){const _0x19df85=_0x3e13c1,_0x2e7b20=document[_0x19df85(0x160)](_0x19df85(0x1e4))[_0x19df85(0x13f)][_0x19df85(0x195)](),_0xd8346=document['getElementById']('newUserPassword')[_0x19df85(0x13f)],_0x317cc2=document[_0x19df85(0x160)]('newUserRole')[_0x19df85(0x13f)],_0xa4a886=document[_0x19df85(0x160)]('newUserLimit')[_0x19df85(0x13f)];if(!_0x2e7b20||!_0xd8346){showAlert('ユーザーIDとパスワードを入力してください。',_0x19df85(0x206));return;}try{userManager[_0x19df85(0x19a)](_0x2e7b20,_0xd8346,_0x317cc2,_0xa4a886),document[_0x19df85(0x160)](_0x19df85(0x1e4))['value']='',document[_0x19df85(0x160)]('newUserPassword')[_0x19df85(0x13f)]='',document[_0x19df85(0x160)](_0x19df85(0x16c))[_0x19df85(0x13f)]='user',document[_0x19df85(0x160)](_0x19df85(0x1fa))[_0x19df85(0x13f)]=_0x19df85(0x151),updateUserTable(),showAlert(_0x19df85(0x13b),'success');}catch(_0x397574){showAlert(_0x397574['message'],_0x19df85(0x178));}}function updateUserTable(){const _0x187672=_0x3e13c1,_0x11dc83=document['getElementById']('userTableBody'),_0x54ea9d=userManager[_0x187672(0x196)]();_0x11dc83[_0x187672(0x17b)]=_0x54ea9d[_0x187672(0x1f7)](_0x576c5b=>_0x187672(0x22c)+_0x576c5b['id']+_0x187672(0x19e)+_0x576c5b[_0x187672(0x245)]+_0x187672(0x19e)+(_0x576c5b[_0x187672(0x219)]||0x0)+_0x187672(0x19e)+_0x576c5b[_0x187672(0x1e6)]+_0x187672(0x129)+_0x576c5b['id']+_0x187672(0x164)+_0x576c5b['id']+'\x27)\x22>削除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20')[_0x187672(0x12a)]('');}window[_0x3e13c1(0x1c6)]=function(_0x3d306c){const _0x5bcba6=_0x3e13c1,_0x1e6959=userManager[_0x5bcba6(0x1f5)][_0x5bcba6(0x13e)](_0x381ce4=>_0x381ce4['id']===_0x3d306c);if(!_0x1e6959)return;const _0x3e86a4=prompt(_0x5bcba6(0x1c5),_0x1e6959['limit']);if(_0x3e86a4&&!isNaN(_0x3e86a4))try{userManager[_0x5bcba6(0x1c6)](_0x3d306c,{'limit':parseInt(_0x3e86a4)}),updateUserTable(),showAlert('ユーザー情報を更新しました。',_0x5bcba6(0x1eb));}catch(_0x42224f){showAlert(_0x42224f['message'],_0x5bcba6(0x178));}},window[_0x3e13c1(0x1d9)]=function(_0x422baa){const _0x15315d=_0x3e13c1;if(confirm(_0x15315d(0x221)+_0x422baa+'\x22\x20を削除しますか？'))try{userManager[_0x15315d(0x1d9)](_0x422baa),updateUserTable(),showAlert(_0x15315d(0x1c1),_0x15315d(0x1eb));}catch(_0x4999b5){showAlert(_0x4999b5[_0x15315d(0x126)],_0x15315d(0x178));}};function loadSettings(){const _0x27c4de=_0x3e13c1;try{const _0x7d7302=localStorage[_0x27c4de(0x181)](_0x27c4de(0x1f2));if(_0x7d7302){const _0x3837e6=JSON[_0x27c4de(0x232)](_0x7d7302);_0x3837e6['claimTypes']?updateClaimTypeOptions(_0x3837e6[_0x27c4de(0x15a)]):updateClaimTypeOptions(DEFAULT_CLAIM_TYPES);}else updateClaimTypeOptions(DEFAULT_CLAIM_TYPES);}catch(_0x172e5c){console[_0x27c4de(0x24b)](_0x27c4de(0x141),_0x172e5c),updateClaimTypeOptions(DEFAULT_CLAIM_TYPES);}}function saveSettings(){const _0x3845f4=_0x3e13c1,_0x4cedcd={'claimTypes':getClaimTypes(),'requiredFields':getRequiredFields(),'colorParams':getCurrentColorParams(),'timestamp':new Date()[_0x3845f4(0x156)]()};localStorage['setItem'](_0x3845f4(0x1f2),JSON[_0x3845f4(0x1f3)](_0x4cedcd));}function getClaimTypes(){const _0x468c76=_0x3e13c1,_0x4c4149=localStorage[_0x468c76(0x181)]('banana_settings');if(_0x4c4149){const _0x156457=JSON['parse'](_0x4c4149);return _0x156457[_0x468c76(0x15a)]||DEFAULT_CLAIM_TYPES;}return DEFAULT_CLAIM_TYPES;}function getRequiredFields(){const _0x3d4946=_0x3e13c1,_0x45b8ad=localStorage['getItem'](_0x3d4946(0x1f2));if(_0x45b8ad){const _0x3a1892=JSON[_0x3d4946(0x232)](_0x45b8ad);return _0x3a1892[_0x3d4946(0x163)]||[_0x3d4946(0x183),_0x3d4946(0x236),_0x3d4946(0x25e)];}return[_0x3d4946(0x183),_0x3d4946(0x236),_0x3d4946(0x25e)];}function updateClaimTypeOptions(_0x53b5e3){const _0x187c66=_0x3e13c1,_0x217cb9=document['getElementById'](_0x187c66(0x1cf));_0x217cb9&&(_0x217cb9[_0x187c66(0x17b)]='<option\x20value=\x22\x22>選択してください</option>'+_0x53b5e3['map'](_0x4e4130=>_0x187c66(0x1a3)+_0x4e4130+'\x22>'+_0x4e4130+_0x187c66(0x144))[_0x187c66(0x12a)](''));}function initializeColorParams(){const _0x160e13=_0x3e13c1,_0x16bb82=getCurrentColorParams();document['getElementById'](_0x160e13(0x21e))[_0x160e13(0x13f)]=_0x16bb82[_0x160e13(0x1e8)][_0x160e13(0x1bc)],document['getElementById'](_0x160e13(0x198))['value']=_0x16bb82[_0x160e13(0x1e8)][_0x160e13(0x207)],document['getElementById'](_0x160e13(0x231))['value']=_0x16bb82[_0x160e13(0x1e8)][_0x160e13(0x135)]*0x64,document[_0x160e13(0x160)](_0x160e13(0x1e7))[_0x160e13(0x13f)]=_0x16bb82[_0x160e13(0x201)]['hueMin'],document[_0x160e13(0x160)]('yellowHueMax')[_0x160e13(0x13f)]=_0x16bb82[_0x160e13(0x201)]['hueMax'],document[_0x160e13(0x160)]('spotValueMin')[_0x160e13(0x13f)]=_0x16bb82[_0x160e13(0x1a2)][_0x160e13(0x244)]*0x64,updateParamValues(),document[_0x160e13(0x1de)](_0x160e13(0x217))['forEach'](_0x210607=>{const _0x3a54a9=_0x160e13;_0x210607[_0x3a54a9(0x148)]('input',updateParamValues);});}function updateParamValues(){const _0x38d983=_0x3e13c1;document[_0x38d983(0x1de)]('.param-range')[_0x38d983(0x208)](_0x1331c5=>{const _0x58fcb9=_0x38d983,_0x4b81d5=_0x1331c5[_0x58fcb9(0x142)][_0x58fcb9(0x193)](_0x58fcb9(0x242));let _0x5a2239=_0x1331c5[_0x58fcb9(0x13f)];(_0x1331c5['id'][_0x58fcb9(0x16d)]('Saturation')||_0x1331c5['id'][_0x58fcb9(0x16d)](_0x58fcb9(0x13a)))&&(_0x5a2239+='%'),_0x4b81d5[_0x58fcb9(0x165)]=_0x5a2239;});}function getCurrentColorParams(){return COLOR_PARAMS;}function saveColorParams(){const _0x5dfbc2=_0x3e13c1;try{const _0x3a9d15={'green':{'hueMin':parseInt(document[_0x5dfbc2(0x160)](_0x5dfbc2(0x21e))[_0x5dfbc2(0x13f)]),'hueMax':parseInt(document['getElementById']('greenHueMax')[_0x5dfbc2(0x13f)]),'saturation':parseInt(document[_0x5dfbc2(0x160)]('greenSaturation')['value'])/0x64,'value':COLOR_PARAMS[_0x5dfbc2(0x1e8)][_0x5dfbc2(0x13f)]},'yellowGreen':COLOR_PARAMS['yellowGreen'],'yellow':{'hueMin':parseInt(document[_0x5dfbc2(0x160)](_0x5dfbc2(0x1e7))[_0x5dfbc2(0x13f)]),'hueMax':parseInt(document[_0x5dfbc2(0x160)]('yellowHueMax')[_0x5dfbc2(0x13f)]),'saturation':COLOR_PARAMS['yellow'][_0x5dfbc2(0x135)],'value':COLOR_PARAMS[_0x5dfbc2(0x201)][_0x5dfbc2(0x13f)]},'spot':{...COLOR_PARAMS[_0x5dfbc2(0x1a2)],'vMin':parseInt(document[_0x5dfbc2(0x160)](_0x5dfbc2(0x121))['value'])/0x64},'brown':COLOR_PARAMS[_0x5dfbc2(0x12b)],'backgroundRemoval':COLOR_PARAMS[_0x5dfbc2(0x1da)]};Object[_0x5dfbc2(0x137)](COLOR_PARAMS,_0x3a9d15),saveSettings(),showAlert(_0x5dfbc2(0x192),_0x5dfbc2(0x1eb));}catch(_0x2e060f){showAlert(_0x5dfbc2(0x251),_0x5dfbc2(0x178)),console[_0x5dfbc2(0x24b)](_0x2e060f);}}function resetColorParams(){const _0x53e687=_0x3e13c1;document['getElementById']('greenHueMin')['value']=0x50,document['getElementById'](_0x53e687(0x198))[_0x53e687(0x13f)]=0x8c,document[_0x53e687(0x160)](_0x53e687(0x231))['value']=0x1e,document[_0x53e687(0x160)]('yellowHueMin')[_0x53e687(0x13f)]=0x2d,document['getElementById'](_0x53e687(0x202))[_0x53e687(0x13f)]=0x41,document[_0x53e687(0x160)](_0x53e687(0x121))[_0x53e687(0x13f)]=0x1e,updateParamValues(),showAlert(_0x53e687(0x209),_0x53e687(0x1dd));}function handleCsvImport(){const _0x25c339=_0x3e13c1,_0x2a3494=document[_0x25c339(0x160)](_0x25c339(0x1d7)),_0x5776c5=_0x2a3494[_0x25c339(0x203)][0x0];if(!_0x5776c5){showAlert('CSVファイルを選択してください。','warning');return;}const _0xef95fd=new FileReader();_0xef95fd['onload']=function(_0xcf3d87){const _0x4032c8=_0x25c339;try{const _0xf12ab=_0xcf3d87[_0x4032c8(0x1d1)][_0x4032c8(0x23c)],_0x5c64d0=_0xf12ab[_0x4032c8(0x227)]('\x0a'),_0x3a36b1=_0x5c64d0[_0x4032c8(0x197)](0x1)[_0x4032c8(0x143)](_0xeba300=>_0xeba300[_0x4032c8(0x195)]())[_0x4032c8(0x1f7)](_0x1a6107=>{const _0x2399f7=_0x4032c8,_0x208fa3=_0x1a6107[_0x2399f7(0x227)](',')[_0x2399f7(0x1f7)](_0x5cc841=>_0x5cc841[_0x2399f7(0x12e)](/"/g,'')['trim']());return _0x208fa3;});showAlert(_0x3a36b1['length']+'件のデータをインポートしました。',_0x4032c8(0x1eb));}catch(_0xe6915f){showAlert(_0x4032c8(0x171),_0x4032c8(0x178)),console[_0x4032c8(0x24b)](_0xe6915f);}},_0xef95fd[_0x25c339(0x22d)](_0x5776c5);}function handlePasswordChange(){const _0x4a7664=_0x3e13c1,_0x269d3a=document[_0x4a7664(0x160)]('currentPassword')[_0x4a7664(0x13f)],_0x486863=document[_0x4a7664(0x160)](_0x4a7664(0x155))[_0x4a7664(0x13f)],_0x28777c=document[_0x4a7664(0x160)](_0x4a7664(0x1af))['value'];if(!_0x269d3a||!_0x486863||!_0x28777c){showAlert('すべてのパスワードフィールドを入力してください。','warning');return;}if(_0x486863!==_0x28777c){showAlert(_0x4a7664(0x262),_0x4a7664(0x206));return;}if(atob(currentUser[_0x4a7664(0x187)])!==_0x269d3a){showAlert(_0x4a7664(0x1ae),_0x4a7664(0x178));return;}try{userManager[_0x4a7664(0x1c6)](currentUser['id'],{'pass':btoa(_0x486863)}),document[_0x4a7664(0x160)]('currentPassword')[_0x4a7664(0x13f)]='',document[_0x4a7664(0x160)](_0x4a7664(0x155))['value']='',document[_0x4a7664(0x160)](_0x4a7664(0x1af))[_0x4a7664(0x13f)]='',showAlert(_0x4a7664(0x124),_0x4a7664(0x1eb));}catch(_0x3f4b31){showAlert(_0x4a7664(0x1b7),_0x4a7664(0x178)),console['error'](_0x3f4b31);}}document[_0x3e13c1(0x148)](_0x3e13c1(0x1dc),initializeApp);(window[_0x3e13c1(0x230)][_0x3e13c1(0x22b)]==='localhost'||window[_0x3e13c1(0x230)][_0x3e13c1(0x22b)]===_0x3e13c1(0x1d0))&&(window[_0x3e13c1(0x23d)]={'currentUser':()=>currentUser,'analysisResult':()=>analysisResult,'colorData':()=>COLOR_DATA,'userManager':()=>userManager});
